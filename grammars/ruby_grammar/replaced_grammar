program:
compstmt
---
compstmt:
stmt OP_NEWLINE opt_term_expr_list
---
opt_term_expr_list:
term_expr_list

---
term_expr_list:
expr term
expr term term_expr_list
---
opt_term:
term

---
stmt:
call KEYWORD_DO opt_do_block_var compstmt KEYWORD_END
KEYWORD_UNDEF fname
KEYWORD_ALIAS fname fname
stmt KEYWORD_IF expr
stmt KEYWORD_WHILE expr
stmt KEYWORD_UNLESS expr
stmt KEYWORD_UNTIL expr
KEYWORD_UBEGIN OP_LBRACE compstmt OP_RBRACE
KEYWORD_UEND OP_LBRACE compstmt OP_RBRACE
lhs OP_EQUAL command KEYWORD_DO opt_do_block_var compstmt KEYWORD_END
lhs OP_EQUAL command
expr
---
opt_do_block_var:
OP_BITOR opt_block_var OP_BITOR

---
opt_block_var:
block_var

---
expr:
mlhs OP_EQUAL mrhs
KEYWORD_RETURN call_args
KEYWORD_YIELD call_args
expr KEYWORD_AND expr
expr KEYWORD_OR expr
KEYWORD_NOT expr
command
OP_NOT command
arg
---
call:
function
command
---
command:
operation call_args
primary OP_DOT operation call_args
primary TCOLON2 operation call_args
KEYWORD_SUPER call_args
---
function:
operation opt_function_call_args
primary OP_DOT operation opt_function_call_args
primary TCOLON2 operation opt_function_call_args
KEYWORD_SUPER opt_function_call_args
---
opt_function_call_args:
function_call_args
%prec KEYWORD_AND
---
function_call_args:
TLPAREN opt_call_args TRPAREN
---
opt_call_args:
call_args

---
arg:
lhs OP_EQUAL arg
arg OP_ADD_WITH arg
arg OP_SUB_WITH arg
arg OP_MUL_WITH arg
arg OP_DIV_WITH arg
arg OP_MOD_WITH arg
arg OP_POW_WITH arg
arg OP_BITAND_WITH arg
arg OP_BITOR_WITH arg
arg OP_BITXOR_WITH arg
arg OP_LSHIFT_WITH arg
arg OP_RSHIFT_WITH arg
arg OP_AND_WITH arg
arg OP_OR_WITH arg
arg TDOT2 arg
arg TDOT3 arg
arg OP_ADD arg
arg TSTAR arg
arg OP_SUB arg
arg OP_DIVIDE arg
arg OP_MOD arg
arg TPOW arg
OP_ADD arg
OP_SUB arg
arg OP_BITOR arg
arg OP_XOR arg
arg TAMPER arg
arg TCMP arg
arg OP_GTEATERTHAN arg
arg TGEQ arg
arg OP_LESSTHAN arg
arg TLEQ arg
arg TEQ arg
arg TEQQ arg
arg TNEQ arg
arg TMATCH arg
arg TNMATCH arg
OP_NOT arg
OP_BITNOT arg
arg TLSHFT arg
arg TRSHFT arg
arg TANDOP arg
arg TOROP arg
KEYWORD_DEFINED arg
primary
---
primary:
TLPAREN compstmt TRPAREN
literal
variable
primary TCOLON2 identifier
TCOLON2 identifier
primary TLBRACK opt_args TRBRACK
TAREF
TLBRACK opt_args_opt_comma TRBRACK
OP_LBRACE opt_args_opt_comma OP_RBRACE
OP_LBRACE assocs_opt_comma OP_RBRACE
KEYWORD_RETURN opt_function_call_args
KEYWORD_YIELD opt_function_call_args
KEYWORD_DEFINED TLPAREN arg TRPAREN
function
function OP_LBRACE opt_do_block_var compstmt OP_RBRACE
KEYWORD_IF expr then compstmt opt_elsif_expr_then_comp_list opt_else_compstmt KEYWORD_END
KEYWORD_UNLESS expr then compstmt opt_else_compstmt KEYWORD_END
KEYWORD_WHILE expr do compstmt KEYWORD_END
KEYWORD_UNTIL expr do compstmt KEYWORD_END
KEYWORD_CASE compstmt when_args_then_compstmt_list opt_else_compstmt KEYWORD_END
KEYWORD_FOR block_var KEYWORD_IN expr do compstmt KEYWORD_END
KEYWORD_BEGIN compstmt opt_rescue_opt_args_do_compstmt_list opt_else_compstmt opt_ensure_compstmt KEYWORD_END
KEYWORD_CLASS identifier opt_less_identifier opt_term compstmt KEYWORD_END
KEYWORD_MODULE identifier opt_term compstmt KEYWORD_END
KEYWORD_DEF fname argdecl compstmt KEYWORD_END
KEYWORD_DEF singleton dot_or_dcolon fname argdecl compstmt KEYWORD_END
---
opt_less_identifier:
OP_LESSTHAN identifier

---
dot_or_dcolon:
OP_DOT
TCOLON2
---
opt_ensure_compstmt:
KEYWORD_ENSURE compstmt

---
opt_rescue_opt_args_do_compstmt_list:
rescue_opt_args_do_compstmt_list

---
rescue_opt_args_do_compstmt_list:
KEYWORD_RESCUE opt_args do compstmt
KEYWORD_RESCUE opt_args do compstmt rescue_opt_args_do_compstmt_list
---
when_args_then_compstmt_list:
KEYWORD_WHEN when_args then compstmt
KEYWORD_WHEN when_args then compstmt when_args_then_compstmt_list
---
opt_elsif_expr_then_comp_list:
elsif_expr_then_comp_list

---
elsif_expr_then_comp_list:
KEYWORD_ELSIF expr then compstmt
KEYWORD_ELSIF expr then compstmt elsif_expr_then_comp_list
---
opt_else_compstmt:
KEYWORD_ELSE opt_term compstmt

---
opt_args:
args

---
opt_args_opt_comma:
args_opt_comma

---
args_opt_comma:
args opt_comma
---
opt_comma:
OP_COMMA

---
assocs_opt_comma:
assocs opt_comma
---
when_args:
args opt_comma_star_arg
TSTAR arg
---
opt_comma_star_arg:
OP_COMMA TSTAR arg

---
then:
term
KEYWORD_THEN
term KEYWORD_THEN
---
do:
term
KEYWORD_DO
term KEYWORD_DO
---
block_var:
lhs
mlhs
---
mlhs:
mlhs_item OP_COMMA opt_mlhs_item_comma_list opt_star_opt_lhs
TSTAR lhs
---
opt_mlhs_item_comma_list:
mlhs_item_comma_list

---
mlhs_item_comma_list:
mlhs_item
mlhs_item OP_COMMA mlhs_item_comma_list
---
opt_star_opt_lhs:
TSTAR
TSTAR lhs

---
mlhs_item:
lhs
TLPAREN mlhs TRPAREN
---
lhs:
variable
primary TLBRACK opt_args TRBRACK
primary OP_DOT identifier
---
mrhs:
args opt_comma_star_arg
TSTAR arg
---
call_args:
args opt_comma_assocs opt_comma_star_arg opt_comma_bitand_arg
assocs opt_comma_star_arg opt_comma_bitand_arg
TSTAR arg opt_comma_bitand_arg
TAMPER arg
command
---
opt_comma_assocs:
OP_COMMA assocs

---
opt_comma_bitand_arg:
OP_COMMA TAMPER arg

---
args:
arg
arg OP_COMMA args
---
argdecl:
TLPAREN arglist TRPAREN opt_term
arglist term
---
arglist:
identifier_list
TSTAR identifier opt_comma_bitand_identifier
opt_bitand_identifier
---
identifier_list:
identifier
identifier_list OP_COMMA opt_tamper_or_star identifier
---
opt_comma_star_opt_identifier:
OP_COMMA TSTAR opt_identifier

---
opt_identifier:
identifier

---
opt_tamper_or_star:
TAMPER
TSTAR

---
opt_comma_bitand_identifier:
OP_COMMA TAMPER identifier

---
opt_bitand_identifier:
TAMPER identifier

---
singleton:
variable
TLPAREN expr TRPAREN
---
assocs:
assoc
assoc OP_COMMA assocs
---
assoc:
arg TASSOC arg
---
variable:
varname
KEYWORD_NIL
KEYWORD_SELF
---
literal:
numeric
string
---
term:
newline_list
OP_SEMI
---
newline_list:
OP_NEWLINE
OP_NEWLINE newline_list
---
fname:
identifier
TDOT2
OP_BITOR
OP_XOR
TAMPER
TCMP
TEQ
TEQQ
TMATCH
OP_GTEATERTHAN
TGEQ
OP_LESSTHAN
TLEQ
OP_ADD
OP_SUB
TSTAR
OP_DIVIDE
OP_MOD
TPOW
TLSHFT
TRSHFT
OP_BITNOT
OP_ADD_AT
OP_SUB_AT
TAREF
TASET
---
operation:
identifier
identifier OP_NOT
identifier OP_QUESTION
---
varname:
rglobal
OP_AT identifier
identifier
---
rglobal:
OP_DOLLAR identifier
OP_DOLLAR OP_SUB identifier
---
string:
string_literal
---
numeric:
float_literal
int_literal
---
identifier:
IDENTIFIER
---
string_literal:
STRINGLITERAL
---
float_literal:
FLOATLITERAL
---
int_literal:
INTLITERAL
---
