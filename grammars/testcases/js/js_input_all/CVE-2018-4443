function setter(arr, value) {
    arr[0] = value;
}

function getImmutableArrayOrSet(getter, value) {
    let arr = [1];
    if (getter)
        return arr;

    setter(arr, value);  // This inlinee is for having checkArray not take the paths using the structure comparison.
    setter({}, 1);
}

function main() {
    getImmutableArrayOrSet(true);

    for (let i = 0; i < 100; i++) {
        getImmutableArrayOrSet(false, {});
    }

    let arr = getImmutableArrayOrSet(true);
    print(arr[0] === 1);
}

main();
